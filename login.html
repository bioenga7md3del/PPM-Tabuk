<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>PPM TABUK • تسجيل الدخول</title>
  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --ink:#e5e7eb; --muted:#9ca3af;
      --acc:#22d3ee; --line:#1f2937; --radius:18px;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    main{min-height:100%;display:grid;place-items:center;padding:24px;position:relative;overflow:hidden}
    /* ووترمارك الخلفية من اللوجو */
    .bg-logo{position:absolute;inset:-10% -10% auto -10%;height:120vh;
      background:url("./assets/TabukCluster.jpeg") center/contain no-repeat;
      opacity:.06;filter:grayscale(100%) contrast(110%);pointer-events:none}
    .card{width:min(100%,880px);background:linear-gradient(180deg,rgba(15,23,42,.85),rgba(15,23,42,.92));
      border:1px solid var(--line);border-radius:18px;box-shadow:0 20px 60px rgba(0,0,0,.45);
      backdrop-filter:saturate(120%) blur(6px);padding:28px}
    .brand{display:flex;gap:18px;align-items:center;margin-bottom:16px}
    .brand-logo{width:84px;height:84px;object-fit:cover;border-radius:20px;border:1px solid var(--line);box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .brand-text h1{margin:0;font-size:28px;letter-spacing:.8px}
    .brand-text p{margin:4px 0 0;color:var(--muted)}
    form{display:grid;gap:10px;margin-top:10px}
    .label{font-weight:600;color:var(--muted)}
    .input{width:100%;padding:14px 16px;border-radius:14px;background:#0b1220;border:1px solid var(--line);color:var(--ink);outline:none}
    .input:focus{border-color:var(--acc);box-shadow:0 0 0 3px rgba(34,211,238,.15)}
    .input-group{display:grid;grid-template-columns:1fr auto;align-items:center;gap:8px}
    .toggle{padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#0b1220;color:var(--muted);cursor:pointer}
    .toggle:hover{border-color:#334155;color:#cbd5e1}
    .error{margin:6px 2px 0;color:#fecaca;display:none}
    .btn{margin-top:6px;padding:14px 18px;border-radius:14px;border:1px solid #155e75;
      background:linear-gradient(90deg,#0ea5e9,#22d3ee);color:#001018;font-weight:800;cursor:pointer}
    .hint{margin:10px 2px 0;color:var(--muted);font-size:.92rem}
    footer{margin-top:16px;text-align:center;color:#94a3b8}
    @media (max-width:640px){.brand{flex-direction:column;text-align:center}.brand-logo{width:72px;height:72px}}
  </style>
</head>
<body>
  <main>
    <div class="bg-logo" aria-hidden="true"></div>

    <section class="card">
      <header class="brand">
        <img src="./assets/TabukCluster.jpeg" class="brand-logo" alt="Tabuk Cluster Logo">
        <div class="brand-text">
          <h1>PPM TABUK</h1>
          <p>Biomedical Department – Tabuk Cluster</p>
        </div>
      </header>

      <form id="loginForm" novalidate>
        <label class="label" for="user">اسم المستخدم أو البريد</label>
        <input id="user" class="input" type="text" placeholder="example@tabuk.sa" autocomplete="username"/>

        <label class="label" for="pass">كلمة المرور</label>
        <div class="input-group">
          <input id="pass" class="input" type="password" placeholder="••••••••" autocomplete="current-password"/>
          <button type="button" class="toggle" id="toggleBtn">إظهار</button>
        </div>

        <p id="err" class="error">من فضلك أدخل اسم المستخدم وكلمة المرور</p>

        <button class="btn" type="submit">تسجيل الدخول</button>
        <p class="hint">بالدخول، تقرّ بسياسات الاستخدام والخصوصية الخاصة بإدارة الصيانة الطبية.</p>
      </form>
    </section>

    <footer>
      <small>© <span id="y"></span> Biomedical Department – Tabuk Cluster</small>
    </footer>
  </main>

 <script>
  document.getElementById('y').textContent = new Date().getFullYear();

  const pass   = document.getElementById('pass');
  const toggle = document.getElementById('toggleBtn');
  toggle.addEventListener('click', ()=> {
    const show = pass.type === 'password';
    pass.type = show ? 'text' : 'password';
    toggle.textContent = show ? 'إخفاء' : 'إظهار';
  });

  document.getElementById('loginForm').addEventListener('submit', (e)=>{
    e.preventDefault();

    const u = document.getElementById('user').value.trim();
    const p = document.getElementById('pass').value.trim();
    const err = document.getElementById('err');
    if(!u || !p){ err.style.display='block'; return; }

    // ✅ احسب اسم الريبو تلقائيًا (GitHub Pages project page)
    const parts = location.pathname.split('/').filter(Boolean);
    // أول جزء في المسار هو اسم الريبو لما تكون الصفحة زي: /PPM-Tabuk/login.html
    const repo = parts.length ? `/${parts[0]}` : '';

    // الهدف النهائي داخل الريبو
    const target = repo ? `${repo}/modules/dashboard/index.html`
                        : 'modules/dashboard/index.html'; // لو بتفتحه محليًا من file://

    // جرّب تطبعه في الكونソل لو حابب تتأكد
    console.log('Redirecting to:', target);

    // التحويل
    window.location.assign(target);
  });
</script>

</body>
</html>
